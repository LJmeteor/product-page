<!DOCTYPE html>
<head>
    <title>Chat Room</title>
    <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.24/jquery.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
    <!--        Jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
</head>

<body>
    <script type="text/javascript">
     $(document).ready(function(){
       var socket=io.connect('http://127.0.0.1:5000')

       socket.on('connect',function(){
        socket.send('User has connected!')
       });
       
       socket.on('message',function(msg){
        $('#messages').append('<li>' + msg+'</li>')
       });
        


        $('form#joinRoom').submit(function (event){
            socket.emit('joinRoom', {
            room:$('#roomNum').val()
            })
            return false
        });
        

        socket.on("roomJoined", function (msg, cb) {
           $('#messages').append('<li>' + msg.user + '  has joined room' + msg.room + '</li>')
        });


        socket.on("roomLeft", function (msg, cb) {
        $('#messages').append('<li>' + msg.user + '  has left room' + msg.room + '</li>')
        });

        socket.on("roomLeftPersonal", function (msg, cb) {
        $('#messages').append('<li>' + ' You have left room' + msg.room + '</li>')
         });



        $('#leave_room').on('click', function (){
        socket.emit('leaveRoom', {
           room: $('#roomNum').val()
            });
        });

       $('#sendbutton').on('click',function(){
        socket.send($('#myMessage').val());
        $('#myMessage').val('');
            });
        });
    </script>
    <h3>Join Room</h3>
        <form id="joinRoom" method="POST" action="#">
            <label>Room Num</label>
            <input type="text" id="roomNum" required>
            <input type="submit" id="submitRoomNum" name="Join the room">
        </form>
        <button id="leave_room">Leave</button>
    <ul id="messages"></ul>
    <input type="text" id="myMessage">
    <button id="sendbutton">Send</button>

</body>
</html>